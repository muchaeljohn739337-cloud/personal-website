# Cloudflare Workers Configuration for Next.js
name = "personal-website"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# For Next.js on Workers (OpenNext build output)
main = ".open-next/worker.js"

# Non-sensitive environment variables
[vars]
NODE_VERSION = "20"
NEXTAUTH_URL = "https://advancia.io"
NODE_ENV = "production"

# R2 Storage Buckets
[[r2_buckets]]
binding = "UPLOADS"
bucket_name = "uploads"

# Assets
[site]
bucket = ".open-next/assets"

# =============================================================================
# SECRETS (must be added via CLI or Dashboard - NOT in this file)
# =============================================================================
# Run these commands to add secrets:
#
# npx wrangler secret put DATABASE_URL
# npx wrangler secret put NEXTAUTH_SECRET
# npx wrangler secret put GOOGLE_CLIENT_ID
# npx wrangler secret put GOOGLE_CLIENT_SECRET
# npx wrangler secret put GITHUB_CLIENT_ID
# npx wrangler secret put GITHUB_CLIENT_SECRET
# npx wrangler secret put RESEND_API_KEY
# npx wrangler secret put STRIPE_SECRET_KEY
# npx wrangler secret put STRIPE_WEBHOOK_SECRET
# =============================================================================

# Production environment
[env.production]
name = "personal-website-prod"
main = ".open-next/worker.js"
[env.production.vars]
NODE_VERSION = "20"
NEXTAUTH_URL = "https://advancia.io"
NODE_ENV = "production"
[[env.production.r2_buckets]]
binding = "UPLOADS"
bucket_name = "uploads"

# Staging environment
[env.staging]
name = "personal-website-staging"
main = ".open-next/worker.js"
[env.staging.vars]
NODE_VERSION = "20"
NEXTAUTH_URL = "https://staging.advancia.io"
NODE_ENV = "staging"
[[env.staging.r2_buckets]]
binding = "UPLOADS"
bucket_name = "uploads-staging"
